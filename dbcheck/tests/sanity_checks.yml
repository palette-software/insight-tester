-
  Description: "http_requests should contain records no older than 180 minutes"
  Sql: "select coalesce(extract('epoch' from (now() at time zone 'utc' - max(created_at))) / 60, 9999)::int as no_change_in_hours, 'NONE' from palette.http_requests"
  Result:
    Operation: "<"
    Count: 180
-
  Description: "threadinfo should contain records no older than 20 minutes"
  Sql: "select coalesce(extract('epoch' from (now() at time zone 'utc' - max(ts))) / 60, 9999)::int as no_change_in_hours, host_name from palette.threadinfo where ts >= now()::date -2 group by host_name"
  Result:
    Operation: "<"
    Count: 20
-
  Description: "serverlogs should contain records no older than 60 minutes"
  Sql: "select coalesce(extract('epoch' from (now() at time zone 'utc' - max(ts))) / 60, 9999)::int as no_change_in_hours, host_name from palette.serverlogs where ts >= now()::date -2 group by host_name"
  Result:
    Operation: "<"
    Count: 60
-
  Description: "p_threadinfo should contain records no older than 180 minutes"
  Sql: "select coalesce(extract('epoch' from (now() at time zone 'utc' - max(ts_rounded_15_secs))) / 60, 9999)::int as no_change_in_hours, 'NONE' from palette.p_threadinfo where ts_rounded_15_secs >= now()::date -2"
  Result:
    Operation: "<"
    Count: 180
-
  Description: "p_cpu_usage should contain records no older than 180 minutes"
  Sql: "select coalesce(extract('epoch' from (now() at time zone 'utc' - max(ts_rounded_15_secs))) / 60, 9999)::int as no_change_in_hours, 'NONE' from palette.p_cpu_usage where ts_rounded_15_secs >= now()::date -2"
  Result:
    Operation: "<"
    Count: 180
-
  Description: "p_cpu_usage_report should contain records no older than 180 minutes'"
  Sql: "select coalesce(extract('epoch' from (now() at time zone 'utc' - max(cpu_usage_ts_rounded_15_secs))) / 60, 9999)::int as no_change_in_hours, 'NONE' from palette.p_cpu_usage_report where cpu_usage_ts_rounded_15_secs >= now()::date -2"
  Result:
    Operation: "<"
    Count: 180
-
  Description: "p_cpu_usage report should contain parent_vizql_sessions for at least 5% of CPU coverage"
  Sql: |
    SELECT
      ((sum(case when vizql_session IS NOT NULL then 1 else 0 end)::DOUBLE PRECISION /  count(1)::DOUBLE PRECISION) * 100)::integer,
      host_name
      from palette.p_cpu_usage
     where process_name='tdeserver64'
       and ts_rounded_15_secs BETWEEN  ((now() - '1 day'::interval) at time zone 'utc') and ((now() at time zone 'utc'))
     group by host_name;
  Result:
    Operation: ">"
    Count: 5
